webpackJsonp([29],{"0eKA":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),s=i("BO1k"),r=i.n(s),o=i("J8Iu"),l=i("9c+7"),c={name:"PowerManage",components:{uploadFile:o.a},mixins:[l.a],data:function(){var e=this;return{total:0,currentRow:{},isSelected:!1,isDisabled:!1,form:{adminRoleName:"",adminRolePermission:"",adminRoleRemark:""},ruleValidateType:{adminRoleName:[{required:!0,message:"请填写权限名称",trigger:"change"}]},searchData:{adminRoleName:"",ascending:!1,orderBy:"adminRoleId",pageNo:1,pageSize:10},isScreen:!1,curTime:"",selTypeMod:!1,columns:[{type:"index",title:"序号",width:60,align:"center",indexMethod:function(t){var i=t._index;return e.searchData.pageSize*(e.searchData.pageNo-1)+i+1}},{title:"权限组名称",render:function(t,i){return t("span",{style:{color:"#2d8cf0",cursor:"pointer"},on:{click:function(){e.showInfo(i.row)}}},i.row.adminRoleName)}}],permissionList:[],roleTree:[],isCreate:!0}},mounted:function(){this.fetchData(),this.getRoleTree();var e=(new Date).toLocaleString("chinese",{hour12:!1});this.curTime=e.substring(0,15)},methods:{isExpandNode:function(e,t,i,a){if(0===e&&t.length>0&&a&&a.length>0){var n=!0,s=!1,o=void 0;try{for(var l,c=r()(t);!(n=(l=c.next()).done);n=!0){var d=l.value;if(-1!==a.indexOf(d[i].toString()))return!0}}catch(e){s=!0,o=e}finally{try{!n&&c.return&&c.return()}finally{if(s)throw o}}}return!1},handleTree:function(e,t,i,a){var n=this,s=[];return e.forEach(function(e){var r=e[t.id];if(!i||1!==r){var o=e[t.title],l=e[t.children],c=!!a&&-1!==a.indexOf(r.toString()),d=n.isExpandNode(e[t.pId],l,t.id,a),m=n.isDisabled;l.length>0&&(l=n.handleTree(l,t,!1,a)),s.push({expand:d,title:o,children:l,id:r,checked:c,disabled:m})}}),s},renderContent:function(e,t){t.root,t.node;var i=t.data,a=i.title;return i.children.length>0?e("span",{style:{fontWeight:"bolder",color:"#2d8cf0"}},[e("span",a)]):e("span",a)},getRoleTree:function(e,t){var i=this;i.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),i.commonUtil.ajaxGetUtil("/permission/findMenuInfo",{},function(a){if(i.$Spin.hide(),1===a.code){var n={id:"adminMenuId",pId:"adminMenuPid",title:"adminMenuPermissionName",children:"menuModelList"},s=a.data,r=i.handleTree(s,n,!0,e);r.length>0&&(1===r[0].id?i.roleTree=r:i.roleTree=[{title:s[0][n.title],expand:!0,children:r}]),e&&t()}else i.$Message.error(a.msg)},function(e){i.$Message.error("网络连接错误"),i.$Spin.hide()},i)},pageNoChange:function(e){this.searchData.pageNo=e,this.fetchData()},pageSizeChange:function(e){this.searchData.pageSize=e,this.fetchData()},fetchData:function(){var e=this;e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/permission/findPermissionList",e.searchData,function(t){if(e.$Spin.hide(),1===t.code){var i=t.data;e.permissionList=i.permissionList,e.total=i.totalCount}else e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e),e.commonUtil.getAuditCountApi(e)},delData:function(){var e=this;e.isSelected?e.$Modal.confirm({title:"删除",content:"确认删除此数据吗？",onOk:function(){e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxDeleteUtil("/permission/deletePermission/"+e.currentRow.adminRoleId,function(t){e.$Spin.hide(),1===t.code?(e.isSelected=!1,e.$Message.success(t.msg),e.fetchData()):e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)}}):e.$Message.warning("您未选择需要删除的内容")},clearFormData:function(){this.form={adminRoleName:"",adminRolePermission:"",adminRoleRemark:""},this.$refs.form.resetFields();var e=this.$refs.uploadFile;e&&e.clearFileItems()},showInfo:function(e){var t=this,i=n()({},e);this.clearFormData(),this.isDisabled=!0,this.isCreate=!1,this.form.adminRolePermission=this.getRoleTree(i.adminRolePermission.split(","),function(){t.form.adminRoleId=i.adminRoleId,t.form.adminRoleName=i.adminRoleName,t.form.adminRoleRemark=i.adminRoleRemark,t.form.fileids=i.fileids,t.selTypeMod=!0})},selectRow:function(e){this.currentRow=e,this.isSelected=!0},modifyData:function(){var e=this,t=n()({},e.currentRow);e.isDisabled=!1,e.isCreate=!1,e.clearFormData(),e.isSelected?e.form.adminRolePermission=e.getRoleTree(t.adminRolePermission.split(","),function(){e.form.adminRoleId=t.adminRoleId,e.form.adminRoleName=t.adminRoleName,e.form.adminRoleRemark=t.adminRoleRemark,e.form.fileids=t.fileids,e.$nextTick(function(){e.$refs.uploadFile.getFileItems()}),e.selTypeMod=!0}):e.$Message.warning("您未选择需要修改的内容")},createData:function(){this.clearFormData(),this.getRoleTree(),this.isCreate=!0,this.isDisabled=!1,this.selTypeMod=!0},filterTreeData:function(){var e=[];return this.$refs.roleTree.getCheckedNodes().forEach(function(t){0===t.children.length&&e.push(t.id)}),e.join(",")},submitType:function(e){var t=this,i=this.form;i.adminRolePermission=t.filterTreeData(),i.fileIds=t.$refs.uploadFile.getFileIds(),t.$refs[e].validate(function(e){e?(t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.isCreate?t.commonUtil.ajaxPostUtil("/permission/addPermission",i,function(e){t.$Spin.hide(),1===e.code?(t.selTypeMod=!1,t.$Message.success(e.msg),t.currentRow={},t.fetchData()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t):t.commonUtil.ajaxPutUtil("/permission/updatePermissionInfo",i,function(e){t.$Spin.hide(),1===e.code?(t.selTypeMod=!1,t.$Message.success(e.msg),t.currentRow={},t.fetchData()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t)):t.$Message.error("请填写好信息")})},resetType:function(e){this.$refs[e].resetFields(),this.selTypeMod=!1},isShowScreen:function(){this.isScreen=!this.isScreen}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"powerManage"},[a("Breadcrumb",{staticClass:"breadcrumb"},[a("BreadcrumbItem",[a("Icon",{attrs:{type:"ios-home-outline"}}),e._v("用户设置\n    ")],1),e._v(" "),a("BreadcrumbItem",{staticClass:"curBreadcrumb"},[a("Icon",{attrs:{type:"logo-buffer"}}),e._v(" 权限设置\n    ")],1),e._v(" "),a("span",{staticClass:"screenContent"},[a("img",{staticStyle:{width:"11px","margin-right":"8px","margin-left":"10px"},attrs:{src:i("hmnq")}}),e._v("\n      "+e._s(e.curTime))]),e._v(" "),a("span",{staticClass:"screenContent"},[a("img",{staticStyle:{width:"10.5px","margin-right":"8px"},attrs:{src:i("0dlO")}}),e._v(" "),a("a",{attrs:{href:"javascript:void(0)"},on:{click:e.isShowScreen}},[e._v("\n        筛选\n        "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1),e._v(" "),e.isScreen?a("Content",{staticClass:"content screenStyle",style:{padding:"24px",background:"#fff",marginBottom:"10px"}},[a("Form",{attrs:{model:e.searchData,"label-width":75}},[a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{staticClass:"labelWidth",attrs:{label:"权限组名称"}},[a("Input",{attrs:{clearable:"",placeholder:"请填写权限组名称"},model:{value:e.searchData.adminRoleName,callback:function(t){e.$set(e.searchData,"adminRoleName",t)},expression:"searchData.adminRoleName"}})],1)],1),e._v(" "),a("Col",{staticStyle:{"text-align":"right"},attrs:{xs:{span:1},lg:{span:2}}},[a("Button",{attrs:{type:"primary"},on:{click:e.fetchData}},[e._v("\n          确认\n        ")])],1)],1)],1)],1):e._e(),e._v(" "),a("Content",{staticClass:"content",style:{padding:"14px 24px",minHeight:"220px",background:"#fff"}},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.createData}},[e._v("\n      新增\n    ")]),e._v(" "),a("Button",{attrs:{type:"primary",icon:"ios-create"},on:{click:e.modifyData}},[e._v("\n      修改\n    ")]),e._v(" "),a("Button",{attrs:{type:"primary",icon:"md-close"},on:{click:e.delData}},[e._v("\n      删除\n    ")]),e._v(" "),a("Button",{attrs:{icon:"md-print"},on:{click:function(t){return t.stopPropagation(),e.printContent(5)}}},[e._v("\n      打印\n    ")]),e._v(" "),a("Button",{attrs:{icon:"md-exit"},on:{click:function(t){return e.excelExcel("/permission/exportPermissionListExcel")}}},[e._v("\n      导出\n    ")]),e._v(" "),a("Table",{ref:"checkTable",staticClass:"table",attrs:{"highlight-row":"",columns:e.columns,data:e.permissionList},on:{"on-current-change":e.selectRow}}),e._v(" "),a("Page",{staticStyle:{"text-align":"right"},attrs:{total:e.total,current:e.searchData.pageNo,"page-size":e.searchData.pageSize,"show-sizer":"",transfer:""},on:{"on-change":e.pageNoChange,"on-page-size-change":e.pageSizeChange}}),e._v(" "),a("Modal",{staticClass:"selStyle specialWidth",attrs:{"mask-closable":!1},model:{value:e.selTypeMod,callback:function(t){e.selTypeMod=t},expression:"selTypeMod"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("请设置权限组信息")])]),e._v(" "),a("Tabs",{staticClass:"innerTabStyle",attrs:{animated:!1,value:"name1"}},[a("TabPane",{attrs:{label:"信息设置",name:"name1"}},[a("Form",{ref:"form",attrs:{model:e.form,rules:e.ruleValidateType,"label-width":80}},[a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"权限名称",prop:"adminRoleName"}},[a("Input",{attrs:{disabled:e.isDisabled,placeholder:"请填写权限名称"},model:{value:e.form.adminRoleName,callback:function(t){e.$set(e.form,"adminRoleName","string"==typeof t?t.trim():t)},expression:"form.adminRoleName"}})],1)],1)],1),e._v(" "),a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"选择权限",prop:"selPower"}},[a("Tree",{ref:"roleTree",staticClass:"roleTree",attrs:{data:e.roleTree,"show-checkbox":"",render:e.renderContent}})],1)],1),e._v(" "),a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"备注"}},[a("Input",{attrs:{disabled:e.isDisabled,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写备注"},model:{value:e.form.adminRoleRemark,callback:function(t){e.$set(e.form,"adminRoleRemark","string"==typeof t?t.trim():t)},expression:"form.adminRoleRemark"}})],1)],1)],1)],1),e._v(" "),a("TabPane",{staticClass:"uploadStyle",attrs:{label:"附件",name:"name2"}},[a("uploadFile",{ref:"uploadFile",attrs:{"is-disabled":e.isDisabled,form:e.form}})],1)],1),e._v(" "),a("p",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{icon:"md-print"}},[e._v("\n          打印\n        ")]),e._v(" "),a("Button",{attrs:{icon:"md-exit"}},[e._v("\n          导出\n        ")]),e._v(" "),e.isDisabled?e._e():a("Button",{staticStyle:{float:"right","margin-left":"8px"},on:{click:function(t){return e.resetType("form")}}},[e._v("\n          取消\n        ")]),e._v(" "),e.isDisabled?e._e():a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.submitType("form")}}},[e._v("\n          确认\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var m=i("VU/8")(c,d,!1,function(e){i("Y/6s")},null,null);t.default=m.exports},"Y/6s":function(e,t){}});
//# sourceMappingURL=29.053ed9a30ec4b9e5e3da.js.map