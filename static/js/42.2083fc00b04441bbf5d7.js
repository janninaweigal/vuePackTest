webpackJsonp([42],{brLD:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),s=a.n(r),o=a("BO1k"),i=a.n(o),n=a("J8Iu"),l=a("9c+7"),c={name:"BudgetManage",components:{uploadFile:n.a},mixins:[l.a],data:function(){var e=this;return{isSelected:!1,isDisabled:!1,transferValue:!0,capitalList:[],formList:[],form:{formName:"",formType:null,capitalId:null,formSource:"",formRemark:""},ruleValidateType:{formName:[{required:!0,message:"请填写表单名称",trigger:"change"}],formType:[{type:"number",required:!0,message:"请填写表单类型",trigger:"change"}],capitalId:[{type:"number",required:!0,message:"请选择资金类别",trigger:"change"}],formSource:[{required:!0,message:"请选择表单来源",trigger:"change"}]},total:0,searchData:{formName:"",capitalId:null,formType:null,ascending:!1,orderBy:"form_id",pageNo:1,pageSize:10},isScreen:!1,curTime:"",popUp:!1,columns:[{type:"index",title:"序号",width:60,align:"center",indexMethod:function(t){var a=t._index;return e.searchData.pageSize*(e.searchData.pageNo-1)+a+1}},{title:"表单类型",key:"formType",render:function(t,a){return t("span",{style:{color:"#2d8cf0",cursor:"pointer"},on:{click:function(){e.showInfo(a.row)}}},a.row.formTypeName)}},{title:"资金类别",key:"capitalName"},{title:"表单名称",key:"formName"},{title:"表单来源",key:"formSource"}],typeList:{0:{name:"工程合同模板"},1:{name:"申报类模板"},2:{name:"检查类模板"},3:{name:"验收类模板"},4:{name:"前期类模板"},5:{name:"实施类模板"}}}},mounted:function(){var e=(new Date).toLocaleString("chinese",{hour12:!1});this.curTime=e.substring(0,15),this.getCapitalList(),this.getFormList()},methods:{pageNoChange:function(e){this.searchData.pageNo=e,this.getFormList()},pageSizeChange:function(e){this.searchData.pageSize=e,this.getFormList()},deleteFormData:function(){var e=this,t=this;t.isSelected?t.$Modal.confirm({title:"删除",content:"确认删除此数据吗？",onOk:function(){t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.commonUtil.ajaxDeleteUtil("/form/deleteForm/"+t.currentRow.formId,function(e){t.$Spin.hide(),1===e.code?(t.isSelected=!1,t.$Message.success(e.msg),t.getFormList()):t.$Message.error(e.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},t)}}):t.$Message.warning("您未选择需要删除的内容")},getFormList:function(){var e=this;e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/form/searchForm/list",e.searchData,function(t){if(e.$Spin.hide(),1===t.code){var a=t.data,r=e.typeList,s=!0,o=!1,n=void 0;try{for(var l,c=i()(a.formList);!(s=(l=c.next()).done);s=!0){var m=l.value;m.formTypeName=r[m.formType]?r[m.formType].name:""}}catch(e){o=!0,n=e}finally{try{!s&&c.return&&c.return()}finally{if(o)throw n}}e.formList=a.formList,e.total=a.totalCount,e.clearFormData()}else e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e),e.commonUtil.getAuditCountApi(e),e.currentRow={}},getCapitalList:function(){var e=this;e.$Spin.show(),e.commonUtil.ajaxPostUtil("/capital/searchCapital/list",{capitalName:""},function(t){if(e.$Spin.hide(),1===t.code){var a=t.data;e.capitalList=a.capitalList}else e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},showInfo:function(e){var t=s()({},e);this.clearFormData(),this.isDisabled=!0,this.showData(t)},showData:function(e){var t=this;this.form=e,this.$nextTick(function(){t.$refs.uploadFile.getFileItems()}),this.popUp=!0},selectRow:function(e){this.currentRow=e,this.isSelected=!0},modifyData:function(){if(this.isSelected){this.isDisabled=!1,this.isCreate=!1,this.clearFormData();var e=s()({},this.currentRow);this.showData(e)}else this.$Message.warning("您未选择需要修改的内容")},clearFormData:function(){this.form={formName:"",formType:null,capitalId:null,formSource:"",formRemark:""},this.$refs.form.resetFields();var e=this.$refs.uploadFile;e&&e.clearFileItems()},createForm:function(){this.clearFormData(),this.isDisabled=!1,this.isCreate=!0,this.popUp=!0},submitType:function(e){var t=this,a=t.form;a.fileIds=t.$refs.uploadFile.getFileIds(),t.$refs[e].validate(function(e){e?(t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.isCreate?t.commonUtil.ajaxPostUtil("/form/addForm",a,function(e){t.$Spin.hide(),1===e.code?(t.popUp=!1,t.$Message.success(e.msg),t.getFormList()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t):t.commonUtil.ajaxPutUtil("/form/updateForm",a,function(e){t.$Spin.hide(),1===e.code?(t.popUp=!1,t.$Message.success(e.msg),t.getFormList()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t),t.currentRow={}):t.$Message.error("请填写好信息")})},isShowScreen:function(){this.isScreen=!this.isScreen}}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Breadcrumb",{staticClass:"breadcrumb"},[r("BreadcrumbItem",[r("Icon",{attrs:{type:"ios-home-outline"}}),e._v("其他管理\n    ")],1),e._v(" "),r("BreadcrumbItem",{staticClass:"curBreadcrumb"},[r("Icon",{attrs:{type:"logo-buffer"}}),e._v(" 表单管理\n    ")],1),e._v(" "),r("span",{staticClass:"screenContent"},[r("img",{staticStyle:{width:"11px","margin-right":"8px","margin-left":"10px"},attrs:{src:a("hmnq")}}),e._v("\n      "+e._s(e.curTime))]),e._v(" "),r("span",{staticClass:"screenContent"},[r("img",{staticStyle:{width:"10.5px","margin-right":"8px"},attrs:{src:a("0dlO")}}),e._v(" "),r("a",{attrs:{href:"javascript:void(0)"},on:{click:e.isShowScreen}},[e._v("\n        筛选\n        "),r("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1),e._v(" "),e.isScreen?r("Content",{staticClass:"content screenStyle",style:{padding:"24px",background:"#fff",marginBottom:"10px"}},[r("Form",{attrs:{model:e.searchData,"label-width":62}},[r("Row",[r("Col",{attrs:{xs:{span:5},lg:{span:22}}},[r("FormItem",{attrs:{label:"表单名称"}},[r("Input",{attrs:{placeholder:"请填写表单名称"},model:{value:e.searchData.formName,callback:function(t){e.$set(e.searchData,"formName",t)},expression:"searchData.formName"}})],1)],1)],1),e._v(" "),r("Row",{staticStyle:{"margin-top":"15px"}},[r("Col",{attrs:{xs:{span:10},lg:{span:10}}},[r("FormItem",{attrs:{label:"表单类型"}},[r("Select",{attrs:{transfer:e.transferValue,filterable:"",clearable:""},model:{value:e.searchData.formType,callback:function(t){e.$set(e.searchData,"formType",t)},expression:"searchData.formType"}},e._l(e.typeList,function(t,a){return r("Option",{key:a,attrs:{value:parseInt(a)}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),r("Col",{attrs:{xs:{span:10},lg:{span:10,offset:2}}},[r("FormItem",{attrs:{label:"资金类别"}},[r("Select",{attrs:{transfer:e.transferValue,filterable:"",clearable:""},model:{value:e.searchData.capitalId,callback:function(t){e.$set(e.searchData,"capitalId",t)},expression:"searchData.capitalId"}},e._l(e.capitalList,function(t){return r("Option",{key:t.capitalId,attrs:{value:t.capitalId}},[e._v(e._s(t.capitalName))])}),1)],1)],1),e._v(" "),r("Col",{staticStyle:{float:"right"},attrs:{xs:{span:1,offset:1},lg:{span:1,offset:1}}},[r("Button",{attrs:{type:"primary"},on:{click:e.getFormList}},[e._v("\n          确认\n        ")])],1)],1)],1)],1):e._e(),e._v(" "),r("Content",{staticClass:"content",style:{padding:"14px 24px",minHeight:"220px",background:"#fff"}},[r("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.createForm}},[e._v("\n      新增\n    ")]),e._v(" "),r("Button",{attrs:{type:"primary",icon:"ios-create"},on:{click:e.modifyData}},[e._v("\n      修改\n    ")]),e._v(" "),r("Button",{attrs:{type:"primary",icon:"md-close"},on:{click:e.deleteFormData}},[e._v("\n      删除\n    ")]),e._v(" "),r("Button",{attrs:{icon:"md-print"},on:{click:function(t){return t.stopPropagation(),e.printContent(14)}}},[e._v("\n      打印\n    ")]),e._v(" "),r("Button",{attrs:{icon:"md-exit"},on:{click:function(t){return e.excelExcel("/form/exportFormListExcel")}}},[e._v("\n      导出\n    ")]),e._v(" "),r("Table",{ref:"checkTable",staticClass:"table",attrs:{"highlight-row":"",columns:e.columns,data:e.formList},on:{"on-current-change":e.selectRow}}),e._v(" "),r("Page",{staticStyle:{"text-align":"right"},attrs:{total:e.total,current:e.searchData.pageNo,"page-size":e.searchData.pageSize,"show-sizer":"",transfer:""},on:{"on-change":e.pageNoChange,"on-page-size-change":e.pageSizeChange}}),e._v(" "),r("Modal",{staticClass:"selStyle specialWidth",attrs:{"mask-closable":!1},model:{value:e.popUp,callback:function(t){e.popUp=t},expression:"popUp"}},[r("p",{attrs:{slot:"header"},slot:"header"},[e.isDisabled?r("span",[e._v("表单信息")]):r("span",[e._v("请添加表单信息")])]),e._v(" "),r("Tabs",{staticClass:"innerTabStyle",attrs:{animated:!1,value:"name1"}},[r("TabPane",{attrs:{label:"信息设置",name:"name1"}},[r("Form",{ref:"form",attrs:{model:e.form,rules:e.ruleValidateType,"label-width":80}},[r("Row",[r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"表单类型",prop:"formType"}},[r("Select",{attrs:{disabled:e.isDisabled,transfer:e.transferValue,filterable:"",clearable:"",placeholder:"请选择表单类型"},model:{value:e.form.formType,callback:function(t){e.$set(e.form,"formType",t)},expression:"form.formType"}},e._l(e.typeList,function(t,a){return r("Option",{key:a,attrs:{value:parseInt(a)}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"资金类别",prop:"capitalId"}},[r("Select",{attrs:{disabled:e.isDisabled,transfer:e.transferValue,clearable:"",filterable:"",placeholder:"请选择资金类别"},model:{value:e.form.capitalId,callback:function(t){e.$set(e.form,"capitalId",t)},expression:"form.capitalId"}},e._l(e.capitalList,function(t){return r("Option",{key:t.capitalId,attrs:{value:t.capitalId}},[e._v(e._s(t.capitalName))])}),1)],1)],1)],1),e._v(" "),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"表单名称",prop:"formName"}},[r("Input",{attrs:{disabled:e.isDisabled,placeholder:"请填写表单名称"},model:{value:e.form.formName,callback:function(t){e.$set(e.form,"formName",t)},expression:"form.formName"}})],1)],1),e._v(" "),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"表单来源",prop:"formSource"}},[r("Input",{attrs:{disabled:e.isDisabled,placeholder:"请填写表单来源"},model:{value:e.form.formSource,callback:function(t){e.$set(e.form,"formSource",t)},expression:"form.formSource"}})],1)],1),e._v(" "),r("Col",{attrs:{span:"24"}},[r("FormItem",{attrs:{label:"使用说明"}},[r("Input",{attrs:{disabled:e.isDisabled,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写使用说明"},model:{value:e.form.formRemark,callback:function(t){e.$set(e.form,"formRemark",t)},expression:"form.formRemark"}})],1)],1)],1)],1),e._v(" "),r("TabPane",{attrs:{label:"附件",name:"name7"}},[r("uploadFile",{ref:"uploadFile",attrs:{"is-disabled":e.isDisabled,form:e.form,"is-pdf":!1,num:2}})],1)],1),e._v(" "),r("p",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{icon:"md-print"}},[e._v("\n          打印\n        ")]),e._v(" "),r("Button",{attrs:{icon:"md-exit"}},[e._v("\n          导出\n        ")]),e._v(" "),e.isDisabled?e._e():r("Button",{staticStyle:{float:"right","margin-left":"8px"},on:{click:function(t){e.popUp=!1}}},[e._v("\n          取消\n        ")]),e._v(" "),e.isDisabled?e._e():r("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.submitType("form")}}},[e._v("\n          确认\n        ")])],1)],1)],1)],1)},staticRenderFns:[]},p=a("VU/8")(c,m,!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=42.2083fc00b04441bbf5d7.js.map