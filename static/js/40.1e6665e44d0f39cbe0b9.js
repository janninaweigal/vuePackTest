webpackJsonp([40],{"48kT":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("woOf"),i=a.n(n),r=a("7s5I"),s=a("J8Iu"),o=a("Q0Ca"),l=a("9c+7"),c={name:"BudgetManage",components:{audit:r.a,uploadFile:s.a},mixins:[l.a],data:function(){var e=this;return{uploadFile:{fileids:null},auditForm:{auditMan:"",result:{color:"blue",name:"正在审核"},auditMessage:"",fileids:null},userInfo:this.$store.state.user.userInfo,curTab:"name1",isbtnShow:!0,form:{projectName:"",implementSite:"",workContent:"",implementJindu:"",allFinancial:"",centralFinancial:"",cityFinancial:"",districtFinancial:"",elseFinancial:"",workTarget:"",expectBenefit:"",projectFileIds:null,fileids:null},formRules:{implementSite:[{type:"string",required:!0,message:"请填写实施地点",trigger:"change"}],workContent:[{required:!0,message:"请填写工作内容",trigger:"change"}],implementJindu:[{required:!0,message:"请填写实施进度",trigger:"change"}],projectName:[{required:!0,message:"请填写项目名称",trigger:"change"}],workTarget:[{required:!0,message:"请填写工作目标",trigger:"change"}],allFinancial:[{type:"number",required:!0,message:"请填写总投资",trigger:"change"}],centralFinancial:[{type:"number",required:!0,message:"请填写中央财政",trigger:"change"}],districtFinancial:[{type:"number",required:!0,message:"请填写区级财政",trigger:"change"}],cityFinancial:[{type:"number",required:!0,message:"请填写市级财政",trigger:"change"}],elseFinancial:[{type:"number",required:!0,message:"请填写其他资金",trigger:"change"}]},curTime:"",isPopUp:!1,transferValue:!0,columns:[{type:"index",title:"序号",width:60,align:"center",fixed:"left"},{title:"实施方案",key:"projectName",render:function(t,a){return t("span",{style:{color:"#2d8cf0",cursor:"pointer"},on:{click:function(){e.showInfo(a.row)}}},a.row.projectName)}},{align:"center",title:"审核状态",key:"auditStatus",fixed:"right",width:120,render:function(t,a){var n=a.row,i=n.auditStatus,r=e.status[i],s=[t("Button",{style:{color:r.color+"!important"},props:{type:"text",size:"small"},on:{click:function(){var t=n.auditTime?Object(o.dateformat)(n.auditTime,"YYYY年MM月DD日 HH:mm:ss"):"";2===i||1===i?(e.auditForm={auditMan:n.auditMan,result:r,auditMessage:n.auditMessage,auditTime:t,fileids:n.fileids},e.$refs.audit.displayAudit()):e.showCheck(n)}}},r.name)];return 2===i&&s.push(t("Button",{style:{color:"green"},props:{type:"text",size:"small"},on:{click:function(){e.showCheck(n)}}},"再次提交")),t("div",s)}}],projectList:[],status:{0:{name:"正在审核",color:"blue"},1:{name:"审核通过",color:"green"},2:{name:"审核未通过",color:"red"},3:{name:"未审核",color:"orange"}},isSelected:!1,isCreate:!1}},mounted:function(){var e=(new Date).toLocaleString("chinese",{hour12:!1});this.getProjectList(),this.curTime=e.substring(0,15)},methods:{clickTab:function(e){this.curTab=e},submitTarget:function(){var e=this,t=e.form;t.fileIds=e.$refs.uploadFile.getFileIds(),e.$refs.form.validate(function(a){a?(e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.isCreate?e.commonUtil.ajaxPostUtil("/project/addProject",t,function(t){e.$Spin.hide(),1===t.code?(e.isPopUp=!1,e.$Message.success(t.msg),e.getProjectList()):e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e):e.commonUtil.ajaxPutUtil("/project/updateProject",t,function(t){e.$Spin.hide(),1===t.code?(e.isPopUp=!1,e.$Message.success(t.msg),e.getProjectList()):e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)):e.$Message.error("请填写好信息")})},getProjectList:function(){var e=this;e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/project/searchProject",{auditBatchType:2},function(t){e.$Spin.hide(),1===t.code?e.projectList=t.data:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e),e.commonUtil.getAuditCountApi(e),e.isSelected=!1,e.currentRow={}},deleteData:function(){var e=this,t=this,a=t.currentRow;t.isSelected?-1!==[2,3].indexOf(a.auditStatus)?t.$Modal.confirm({title:"删除",content:"确认删除此数据吗？",onOk:function(){t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.commonUtil.ajaxDeleteUtil("/project/deleteProject/"+a.projectId,function(e){t.$Spin.hide(),1===e.code?(t.isSelected=!1,t.$Message.success(e.msg),t.getProjectList()):t.$Message.error(e.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},t)}}):t.$Message.warning("该审核状态下不能删除数据"):t.$Message.warning("您未选择需要删除的内容")},clearFormData:function(){this.form={projectName:"",implementSite:"",workContent:"",implementJindu:"",allFinancial:"",centralFinancial:"",cityFinancial:"",districtFinancial:"",elseFinancial:"",workTarget:"",expectBenefit:""},this.$refs.form.resetFields();var e=this.$refs.uploadFile;e&&e.clearFileItems()},addTableInfo:function(){this.clearFormData(),this.curTab="name1",this.isCreate=!0,this.isbtnShow=!0,this.isPopUp=!0},selectRow:function(e){this.currentRow=e,this.isSelected=!0},modifyData:function(){if(this.isSelected){var e=i()({},this.currentRow),t=e.auditStatus,a=-1!==[2,3].indexOf(t);this.curTab="name1",this.isCreate=!1,this.isbtnShow=a,this.showData(e)}else this.$Message.warning("您未选择需要修改的内容")},showInfo:function(e){var t=i()({},e);this.curTab="name1",this.isbtnShow=!1,this.showData(t)},showData:function(e){var t=this;this.form=e,this.uploadFile.fileids=e.projectFileIds,this.$nextTick(function(){t.$refs.uploadFile.getFileItems()}),this.isPopUp=!0},showCheck:function(e){var t=this;1!==e.auditStatus?t.$Modal.confirm({title:"是否确认提交审核",content:"",onOk:function(){t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.commonUtil.ajaxPutUtil("/auditBatch/updateAuditBatch",{auditBatchId:e.auditBatchId,auditStatus:0},function(e){t.$Spin.hide(),1===e.code?(t.$Message.success(e.msg),t.getProjectList()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t)}}):t.$Message.error("项目已经审核通过，无需继续提交")}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Breadcrumb",{staticClass:"breadcrumb"},[n("BreadcrumbItem",[n("Icon",{attrs:{type:"ios-home-outline"}}),e._v("申报管理\n    ")],1),e._v(" "),n("BreadcrumbItem",{staticClass:"curBreadcrumb"},[n("Icon",{attrs:{type:"logo-buffer"}}),e._v(" 实施方案\n    ")],1),e._v(" "),n("span",{staticClass:"screenContent"},[n("img",{staticStyle:{width:"11px","margin-right":"8px","margin-left":"10px"},attrs:{src:a("hmnq")}}),e._v("\n      "+e._s(e.curTime))])],1),e._v(" "),n("Content",{staticClass:"content",style:{padding:"14px 24px",background:"#fff"}},[n("Button",{attrs:{type:"primary",disabled:1===e.projectList.length,icon:"md-add"},on:{click:e.addTableInfo}},[e._v("\n      新增\n    ")]),e._v(" "),n("Button",{attrs:{type:"primary",icon:"ios-create"},on:{click:e.modifyData}},[e._v("\n      修改\n    ")]),e._v(" "),n("Button",{attrs:{type:"primary",icon:"md-close"},on:{click:e.deleteData}},[e._v("\n      删除\n    ")]),e._v(" "),n("Button",{attrs:{icon:"md-print"},on:{click:function(t){return t.stopPropagation(),e.printContent(11)}}},[e._v("\n      打印\n    ")]),e._v(" "),n("Button",{attrs:{icon:"md-exit"},on:{click:function(t){return e.excelExcel("/project/exportProjectListExcel")}}},[e._v("\n      导出\n    ")]),e._v(" "),n("Table",{ref:"checkTable",staticClass:"table",attrs:{"highlight-row":"",columns:e.columns,data:e.projectList},on:{"on-current-change":e.selectRow}}),e._v(" "),n("Modal",{staticClass:"selStyle specialWidth",attrs:{"mask-closable":!1},model:{value:e.isPopUp,callback:function(t){e.isPopUp=t},expression:"isPopUp"}},[n("p",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("请填写实施方案信息")])]),e._v(" "),n("Form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":80}},[n("Tabs",{staticClass:"innerTabStyle",attrs:{animated:!1,value:e.curTab},on:{"on-click":e.clickTab}},[n("TabPane",{attrs:{label:"基本信息",name:"name1"}},[n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"项目名称",prop:"projectName"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写项目名称"},model:{value:e.form.projectName,callback:function(t){e.$set(e.form,"projectName","string"==typeof t?t.trim():t)},expression:"form.projectName"}})],1)],1)],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"承担单位"}},[n("Input",{attrs:{disabled:""},model:{value:e.userInfo.orgName,callback:function(t){e.$set(e.userInfo,"orgName","string"==typeof t?t.trim():t)},expression:"userInfo.orgName"}})],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"资金类别"}},[n("Input",{attrs:{disabled:""},model:{value:e.userInfo.capitalName,callback:function(t){e.$set(e.userInfo,"capitalName","string"==typeof t?t.trim():t)},expression:"userInfo.capitalName"}})],1)],1)],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"主管单位"}},[n("Input",{attrs:{disabled:""},model:{value:e.userInfo.manageOrgName,callback:function(t){e.$set(e.userInfo,"manageOrgName","string"==typeof t?t.trim():t)},expression:"userInfo.manageOrgName"}})],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"实施地点",prop:"implementSite"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写实施地点"},model:{value:e.form.implementSite,callback:function(t){e.$set(e.form,"implementSite","string"==typeof t?t.trim():t)},expression:"form.implementSite"}})],1)],1)],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"工作内容",prop:"workContent"}},[n("Input",{attrs:{disabled:!e.isbtnShow,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写工作内容"},model:{value:e.form.workContent,callback:function(t){e.$set(e.form,"workContent","string"==typeof t?t.trim():t)},expression:"form.workContent"}})],1)],1)],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"实施进度",prop:"implementJindu"}},[n("Input",{attrs:{disabled:!e.isbtnShow,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写实施进度"},model:{value:e.form.implementJindu,callback:function(t){e.$set(e.form,"implementJindu","string"==typeof t?t.trim():t)},expression:"form.implementJindu"}})],1)],1)],1)],1),e._v(" "),n("TabPane",{attrs:{label:"资金构成",name:"name2"}},[n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"总投资",prop:"allFinancial"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写总投资",number:""},model:{value:e.form.allFinancial,callback:function(t){e.$set(e.form,"allFinancial","string"==typeof t?t.trim():t)},expression:"form.allFinancial"}},[n("span",{attrs:{slot:"append"},slot:"append"},[e._v("万元")])])],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}})],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"中央财政",prop:"centralFinancial"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写中央财政",number:""},model:{value:e.form.centralFinancial,callback:function(t){e.$set(e.form,"centralFinancial","string"==typeof t?t.trim():t)},expression:"form.centralFinancial"}},[n("span",{attrs:{slot:"append"},slot:"append"},[e._v("万元")])])],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}})],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"市级财政",prop:"cityFinancial"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写市级财政",number:""},model:{value:e.form.cityFinancial,callback:function(t){e.$set(e.form,"cityFinancial","string"==typeof t?t.trim():t)},expression:"form.cityFinancial"}},[n("span",{attrs:{slot:"append"},slot:"append"},[e._v("万元")])])],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}})],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"区级财政",prop:"districtFinancial"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写区级财政",number:""},model:{value:e.form.districtFinancial,callback:function(t){e.$set(e.form,"districtFinancial","string"==typeof t?t.trim():t)},expression:"form.districtFinancial"}},[n("span",{attrs:{slot:"append"},slot:"append"},[e._v("万元")])])],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}})],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"其他资金",prop:"elseFinancial"}},[n("Input",{attrs:{disabled:!e.isbtnShow,placeholder:"请填写其他资金",number:""},model:{value:e.form.elseFinancial,callback:function(t){e.$set(e.form,"elseFinancial","string"==typeof t?t.trim():t)},expression:"form.elseFinancial"}},[n("span",{attrs:{slot:"append"},slot:"append"},[e._v("万元")])])],1)],1)],1)],1),e._v(" "),n("TabPane",{attrs:{label:"效益目标",name:"name3"}},[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"工作目标",prop:"workTarget"}},[n("Input",{attrs:{disabled:!e.isbtnShow,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写工作目标"},model:{value:e.form.workTarget,callback:function(t){e.$set(e.form,"workTarget","string"==typeof t?t.trim():t)},expression:"form.workTarget"}})],1)],1),e._v(" "),n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"预期效益"}},[n("Input",{attrs:{disabled:!e.isbtnShow,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写预期效益"},model:{value:e.form.expectBenefit,callback:function(t){e.$set(e.form,"expectBenefit","string"==typeof t?t.trim():t)},expression:"form.expectBenefit"}})],1)],1)],1),e._v(" "),n("TabPane",{staticClass:"uploadStyle",attrs:{label:"附件",name:"name4"}},[n("uploadFile",{ref:"uploadFile",attrs:{"is-disabled":!e.isbtnShow,form:e.uploadFile}})],1)],1)],1),e._v(" "),n("p",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{icon:"md-print"}},[e._v("\n          打印\n        ")]),e._v(" "),n("Button",{attrs:{icon:"md-exit"}},[e._v("\n          导出\n        ")]),e._v(" "),e.isbtnShow?n("Button",{staticStyle:{float:"right","margin-left":"8px"},on:{click:function(t){e.isPopUp=!1}}},[e._v("\n          取消\n        ")]):e._e(),e._v(" "),e.isbtnShow?n("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.submitTarget()}}},[e._v("\n          确认\n        ")]):e._e()],1)],1)],1),e._v(" "),n("audit",{ref:"audit",attrs:{form:e.auditForm}})],1)},staticRenderFns:[]},p=a("VU/8")(c,m,!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=40.1e6665e44d0f39cbe0b9.js.map