webpackJsonp([28],{QVHq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),s=a.n(r),i=a("Q0Ca"),n=a("J8Iu"),o=a("9c+7"),l={name:"UserManage",components:{uploadFile:n.a},mixins:[o.a],data:function(){var e=this;return{isCreate:!1,permissionList:[],officeList:[],manaOfficeList:[],capitalList:[],linkManList:[],orgList:[],total:0,isDisabled:!1,transferValue:!0,form:{username:"",identity:"",password:"",passwordConfirm:"",danweiIdUse:"",linkManId:"",roleId:"",orgIdUse:"",manaDanweiId:"",manaOrgId:"",capitalId:"",userRemark:""},ruleValidateType:{manaOrgId:[{type:"number",required:!0,message:"请选择主管部门",trigger:"blur"}],manaDanweiId:[{type:"number",required:!0,message:"请选择主管单位",trigger:"change"}],capitalId:[{type:"number",required:!0,message:"请选择资金类别",trigger:"change"}],roleId:[{type:"number",required:!0,message:"请选择权限组",trigger:"change"}],linkManId:[{type:"number",required:!0,message:"请选择使用人",trigger:"blur"}],danweiIdUse:[{type:"number",required:!0,message:"请选择使用单位",trigger:"change"}],username:[{required:!0,message:"请填写用户名",trigger:"blur"}],identity:[{type:"number",required:!0,message:"请选择身份",trigger:"change"}],orgIdUse:[{type:"number",required:!1,message:"请选择使用部门",trigger:"change"}],password:[{required:!0,validator:function(t,a,r){""===a?r(new Error("请输入密码")):(e.form.passwordConfirm===e.form.password&&e.$refs.form.validateField("passwordConfirm"),r())},trigger:"change"},{type:"string",min:6,message:"密码不能小于6位",trigger:"change"}],passwordConfirm:[{required:!0,validator:function(t,a,r){var s=e.form.passwordConfirm;""===s?r(new Error("请输入确认密码")):s!==e.form.password?r(new Error("密码与确认密码不一致")):r()},trigger:"change"}]},searchData:{orgName:"",roleId:"",identityId:"",username:"",ascending:!1,orderBy:"userId",pageNo:1,pageSize:10},isScreen:!1,curTime:"",showContact:!1,selTypeMod:!1,checkText:"提交审核",identity:{1:"一般用户",2:"查询用户",3:"审核用户",4:"超级用户"},columns:[{type:"index",title:"序号",width:60,align:"center",indexMethod:function(t){var a=t._index;return e.searchData.pageSize*(e.searchData.pageNo-1)+a+1}},{title:"事件日期",width:180,key:"roleName"},{title:"事件",key:"roleName"},{title:"摘要",key:"orgName"},{title:"查询编码",key:"linkManName",width:90},{title:"审核情况",width:150,key:"createTime",render:function(e,t){return e("div",Object(i.dateformat)(t.row.createTime,"YYYY-MM-DD HH:mm"))}}],data:[],currentRow:{}}},mounted:function(){this.getUserData(),this.getOfficeData(),this.getFundData(),this.getPowerData(),this.getOrganize(),this.getContactData();var e=(new Date).toLocaleString("chinese",{hour12:!1});this.curTime=e.substring(0,15)},methods:{pageNoChange:function(e){this.searchData.pageNo=e,this.getUserData()},pageSizeChange:function(e){this.searchData.pageSize=e,this.getUserData()},getUserData:function(){var e=this;e.$set(e,"data",[]),e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/user/selectUser/list",e.searchData,function(t){if(e.$Spin.hide(),1===t.code){var a=t.data;e.data=a.userModelList,e.total=a.totalCount}else e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e),e.commonUtil.getAuditCountApi(e),e.currentRow={}},clearData:function(){this.form={identity:"",password:"",passwordConfirm:"",danweiIdUse:"",linkManId:"",roleId:"",orgIdUse:"",manaDanweiId:"",manaOrgId:"",capitalId:"",userRemark:"",fileIds:null},this.$refs.form.resetFields();var e=this.$refs.uploadFile;e&&e.clearFileItems()},showInfo:function(e){var t=this,a=s()({},e);this.clearData(),this.isDisabled=!0,this.form=a,this.form.passwordConfirm=a.password,this.$nextTick(function(){t.$refs.uploadFile.getFileItems()}),this.selTypeMod=!0},selectRow:function(e){this.isSelected=!0,this.currentRow=e},modifyData:function(){var e=this,t=e.currentRow;e.clearData(),e.isCreate=!1,e.isDisabled=!1,e.isSelected?(e.form=s()({},t),e.form.passwordConfirm=t.password,e.getOfficeData(!0,1,function(){e.getOfficeData(!0,0,function(){e.form.linkManId=t.linkManId,e.form.orgIdUse=t.orgIdUse,e.form.manaOrgId=t.manaOrgId,e.form.fileids=t.fileids,e.$nextTick(function(){e.$refs.uploadFile.getFileItems()}),e.$forceUpdate(),e.selTypeMod=!0})})):e.$Message.warning("您未选择需要修改的内容")},deleteData:function(){var e=this,t=this;t.isSelected?t.$Modal.confirm({title:"删除",content:"确认删除此数据吗？",onOk:function(){t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.commonUtil.ajaxDeleteUtil("/user/deleteUser/"+t.currentRow.userId,function(e){t.$Spin.hide(),1===e.code?(t.isSelected=!1,t.$Message.success(e.msg),t.getUserData()):t.$Message.error(e.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},t)}}):t.$Message.warning("您未选择需要删除的内容")},createData:function(){this.isCreate=!0,this.isDisabled=!1,this.clearData(),this.$forceUpdate(),this.selTypeMod=!0},getPowerData:function(){var e=this;e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/permission/findPermissionList",{adminRoleName:""},function(t){e.$Spin.hide(),1===t.code?e.permissionList=t.data.permissionList:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},submitType:function(e){var t=this,a=t.form;a.fileIds=t.$refs.uploadFile.getFileIds(),t.$refs[e].validate(function(e){e?(t.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),t.isCreate?t.commonUtil.ajaxPostUtil("/user/addUser",a,function(e){t.$Spin.hide(),1===e.code?(t.selTypeMod=!1,t.$Message.success(e.msg),t.getUserData()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t):t.commonUtil.ajaxPutUtil("/user/updateUser",a,function(e){t.$Spin.hide(),1===e.code?(t.selTypeMod=!1,t.$Message.success(e.msg),t.getUserData()):t.$Message.error(e.msg)},function(e){t.$Message.error("网络连接错误"),t.$Spin.hide()},t),t.currentRow={}):t.$Message.error("请填写好信息")})},resetType:function(e){this.selTypeMod=!1},isShowScreen:function(){this.isScreen=!this.isScreen},getOrganize:function(){var e=this;e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/organization/searchOrganization/list",{orgType:"",orgName:"",ascending:!1,orderBy:"orgId"},function(t){e.$Spin.hide(),1===t.code?e.orgList=t.data.orgList:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},getLinkManData:function(e){this.getContactData(!0,this.form.danweiIdUse,e)},getContactData:function(e,t,a,r){var s=this;s.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),s.commonUtil.ajaxPostUtil("/linkMan/searchLinkMan/list",{orgId:e?t:null,officeId:e?a:null,linkManName:"",ascending:!1,orderBy:"linkManId"},function(e){s.$Spin.hide(),1===e.code?(s.linkManList=e.data.linkManList,r&&r(!0)):s.$Message.error(e.msg)},function(e){r&&r(!1),s.$Message.error("网络连接错误"),s.$Spin.hide()},s)},getOfficeData:function(e,t,a){var r=this;r.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}});var s=null;if(e){var i=this.form;s=1===t?i.danweiIdUse:i.manaDanweiId}r.commonUtil.ajaxPostUtil("/office/searchOffice/list",{orgId:s,officeName:""},function(i){if(r.$Spin.hide(),1===i.code){var n=i.data.officeList;e?1===t?(a||(r.form.linkManId=null,r.form.orgIdUse=null),r.officeList=n,r.getContactData(!0,s,r.form.orgIdUse,a)):(r.manaOfficeList=n,a?a(!0):r.form.manaOrgId=null):(r.officeList=n,r.manaOfficeList=n)}else r.$Message.error(i.msg)},function(e){a&&a(!1),r.$Message.error("网络连接错误"),r.$Spin.hide()},r)},getFundData:function(){var e=this;e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),e.commonUtil.ajaxPostUtil("/capital/searchCapital/list",{capitalName:"",ascending:!1,orderBy:"capitalId"},function(t){e.$Spin.hide(),1===t.code?e.capitalList=t.data.capitalList:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Breadcrumb",{staticClass:"breadcrumb"},[r("BreadcrumbItem",[r("Icon",{attrs:{type:"ios-home-outline"}}),e._v("图像文件\n    ")],1),e._v(" "),r("BreadcrumbItem",{staticClass:"curBreadcrumb"},[r("Icon",{attrs:{type:"logo-buffer"}}),e._v("图像管理\n    ")],1),e._v(" "),r("span",{staticClass:"screenContent"},[r("img",{staticStyle:{width:"11px","margin-right":"8px","margin-left":"10px"},attrs:{src:a("hmnq")}}),e._v("\n      "+e._s(e.curTime))]),e._v(" "),r("span",{staticClass:"screenContent"},[r("img",{staticStyle:{width:"10.5px","margin-right":"8px"},attrs:{src:a("0dlO")}}),e._v(" "),r("a",{attrs:{href:"javascript:void(0)"},on:{click:e.isShowScreen}},[e._v("\n        筛选\n        "),r("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1),e._v(" "),e.isScreen?r("Content",{staticClass:"content isScreen",style:{padding:"24px",background:"#fff",marginBottom:"10px"}},[r("Form",{attrs:{model:e.searchData,"label-width":62}},[r("Row",[r("Col",{staticStyle:{"margin-bottom":"15px"},attrs:{xs:{span:5},lg:{span:22}}},[r("FormItem",{attrs:{label:"单位名称"}},[r("Input",{attrs:{placeholder:"请填写单位名称"},model:{value:e.searchData.orgName,callback:function(t){e.$set(e.searchData,"orgName",t)},expression:"searchData.orgName"}})],1)],1)],1),e._v(" "),r("Row",[r("Col",{attrs:{xs:{span:7},lg:{span:7}}},[r("FormItem",{attrs:{label:"用户名"}},[r("Input",{attrs:{placeholder:"请填写用户名"},model:{value:e.searchData.username,callback:function(t){e.$set(e.searchData,"username",t)},expression:"searchData.username"}})],1)],1),e._v(" "),r("Col",{staticClass:"userScreen",attrs:{xs:{span:7},lg:{span:7}}},[r("FormItem",{attrs:{label:"身份"}},[e.isDisabled?r("Input",{attrs:{disabled:"",placeholder:"请填写身份"},model:{value:e.searchData.orgName,callback:function(t){e.$set(e.searchData,"orgName","string"==typeof t?t.trim():t)},expression:"searchData.orgName"}}):r("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择身份",transfer:e.transferValue},model:{value:e.searchData.identityId,callback:function(t){e.$set(e.searchData,"identityId",t)},expression:"searchData.identityId"}},[r("Option",{attrs:{value:"1"}},[e._v("一般用户")]),e._v(" "),r("Option",{attrs:{value:"2"}},[e._v("查询用户")]),e._v(" "),r("Option",{attrs:{value:"3"}},[e._v("审核用户")]),e._v(" "),r("Option",{attrs:{value:"4"}},[e._v("超级用户")])],1)],1)],1),e._v(" "),r("Col",{staticClass:"userScreen",attrs:{xs:{span:7},lg:{span:7}}},[r("FormItem",{attrs:{label:"权限组"}},[r("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择权限组"},model:{value:e.searchData.roleId,callback:function(t){e.$set(e.searchData,"roleId",t)},expression:"searchData.roleId"}},e._l(e.permissionList,function(t){return r("Option",{key:t.adminRoleId,attrs:{value:t.adminRoleId}},[e._v(e._s(t.adminRoleName))])}),1)],1)],1),e._v(" "),r("Col",{staticStyle:{float:"right"},attrs:{xs:{span:1},lg:{span:1,offset:1}}},[r("Button",{attrs:{type:"primary"},on:{click:e.getUserData}},[e._v("\n          确认\n        ")])],1)],1)],1)],1):e._e(),e._v(" "),r("Content",{staticClass:"content",style:{padding:"14px 24px",minHeight:"220px",background:"#fff"}},[r("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.createData}},[e._v("\n      新增\n    ")]),e._v(" "),r("Button",{attrs:{type:"primary",icon:"ios-create"},on:{click:e.modifyData}},[e._v("\n      修改\n    ")]),e._v(" "),r("Button",{attrs:{type:"primary",icon:"md-close"},on:{click:e.deleteData}},[e._v("\n      删除\n    ")]),e._v(" "),r("Button",{attrs:{icon:"md-print"},on:{click:function(t){return t.stopPropagation(),e.printContent(6)}}},[e._v("\n      打印\n    ")]),e._v(" "),r("Button",{attrs:{icon:"md-exit"},on:{click:function(t){return e.excelExcel("/user/exportUserListExcel")}}},[e._v("\n      导出\n    ")]),e._v(" "),r("Table",{ref:"checkTable",staticClass:"table",attrs:{"highlight-row":"",columns:e.columns,data:e.data},on:{"on-current-change":e.selectRow}}),e._v(" "),r("Page",{staticStyle:{"text-align":"right"},attrs:{total:e.total,current:e.searchData.pageNo,"page-size":e.searchData.pageSize,"show-sizer":"",transfer:""},on:{"on-change":e.pageNoChange,"on-page-size-change":e.pageSizeChange}}),e._v(" "),r("Modal",{staticClass:"selStyle specialWidth",attrs:{"mask-closable":!1},model:{value:e.selTypeMod,callback:function(t){e.selTypeMod=t},expression:"selTypeMod"}},[r("p",{attrs:{slot:"header"},slot:"header"},[!e.isDisabled&&e.isCreate?r("span",[e._v("请设置用户信息")]):r("span",[e._v("用户信息")])]),e._v(" "),r("Tabs",{staticClass:"innerTabStyle",attrs:{animated:!1,value:"name1"}},[r("TabPane",{attrs:{label:"图像信息",name:"name1"}},[r("Form",{ref:"form",attrs:{model:e.form,rules:e.ruleValidateType,"label-width":80}},[r("Row",[r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"事件日期",prop:"username"}},[r("Input",{attrs:{disabled:e.isDisabled,placeholder:"请填写用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username","string"==typeof t?t.trim():t)},expression:"form.username"}})],1)],1),e._v(" "),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"事件",prop:"identity"}},[r("Select",{attrs:{disabled:e.isDisabled,clearable:"",filterable:"",placeholder:"请选择身份"},model:{value:e.form.identity,callback:function(t){e.$set(e.form,"identity",t)},expression:"form.identity"}},e._l(e.identity,function(t,a){return r("Option",{key:a,attrs:{value:parseInt(a)}},[e._v(e._s(t))])}),1)],1)],1)],1),e._v(" "),r("Col",{attrs:{span:"24"}},[r("FormItem",{attrs:{label:"摘要",prop:"capitalId"}},[r("Select",{attrs:{disabled:e.isDisabled,transfer:e.transferValue,clearable:"",filterable:"",placeholder:"请选择资金类别"},model:{value:e.form.capitalId,callback:function(t){e.$set(e.form,"capitalId",t)},expression:"form.capitalId"}},e._l(e.capitalList,function(t){return r("Option",{key:t.capitalId,attrs:{value:t.capitalId}},[e._v(e._s(t.capitalName))])}),1)],1)],1),e._v(" "),r("Col",{attrs:{span:"24"}},[r("FormItem",{attrs:{label:"备注"}},[r("Input",{attrs:{disabled:e.isDisabled,type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"请填写备注"},model:{value:e.form.userRemark,callback:function(t){e.$set(e.form,"userRemark","string"==typeof t?t.trim():t)},expression:"form.userRemark"}})],1)],1)],1)],1),e._v(" "),r("TabPane",{staticClass:"uploadStyle",attrs:{label:"附件",name:"name2"}},[r("uploadFile",{ref:"uploadFile",attrs:{"is-disabled":e.isDisabled,form:e.form,"is-pdf":!1,"is-jpg":!0}})],1)],1),e._v(" "),r("p",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{icon:"md-print"}},[e._v("\n          打印\n        ")]),e._v(" "),r("Button",{attrs:{icon:"md-exit"}},[e._v("\n          导出\n        ")]),e._v(" "),e.isDisabled?e._e():r("Button",{staticStyle:{float:"right","margin-left":"8px"},on:{click:function(t){return e.resetType("form")}}},[e._v("\n          取消\n        ")]),e._v(" "),e.isDisabled?e._e():r("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.submitType("form")}}},[e._v("\n          确认\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(l,c,!1,function(e){a("xoOv")},null,null);t.default=d.exports},xoOv:function(e,t){}});
//# sourceMappingURL=28.81cedd84d4bb0beaf7a7.js.map