webpackJsonp([1],{"5zde":function(e,t,a){a("zQR9"),a("qyJz"),e.exports=a("FeBl").Array.from},CvEL:function(e,t){},Gu7T:function(e,t,a){"use strict";t.__esModule=!0;var i,n=a("c/Tr"),r=(i=n)&&i.__esModule?i:{default:i};t.default=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return(0,r.default)(e)}},Mhyx:function(e,t,a){var i=a("/bQp"),n=a("dSzd")("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[n]===e)}},T1Xa:function(e,t,a){"use strict";t.a=function(e,t){var a,r="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop32.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",s="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop32.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",o="<br><font color='#FF00FF'>CLodop云打印服务需升级!点击这里<a href='CLodop_Setup_for_Win32NT.exe' target='_self'>执行升级</a>,升级后请刷新页面。</font>";try{var c=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0;if(n()){try{a=getCLodop()}catch(e){}if(!a&&"complete"!==document.readyState)return void alert("C-Lodop没准备好，请稍后再试！");a&&(CLODOP.CVERSION<"3.0.0.2"&&(c?document.write(o):document.documentElement.innerHTML=o+document.documentElement.innerHTML),t&&t.parentNode&&t.parentNode.removeChild(t),e&&e.parentNode&&e.parentNode.removeChild(e))}else{var l=c&&navigator.userAgent.indexOf("x64")>=0;if(void 0!==e||void 0!==t?a=c?e:t:null==i?((a=document.createElement("object")).setAttribute("width",0),a.setAttribute("height",0),a.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;"),c?a.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA"):a.setAttribute("type","application/x-print-lodop"),document.documentElement.appendChild(a),i=a):a=i,null==a||void 0===a.VERSION)return navigator.userAgent.indexOf("Chrome")>=0&&(document.documentElement.innerHTML="<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>"+document.documentElement.innerHTML),navigator.userAgent.indexOf("Firefox")>=0&&(document.documentElement.innerHTML="<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>"+document.documentElement.innerHTML),l?document.write("<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop64.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>"):c?document.write(r):document.documentElement.innerHTML=r+document.documentElement.innerHTML,a}return a.VERSION<"6.0"?(n()||(l?document.write("<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop64.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>"):c?document.write(s):document.documentElement.innerHTML=s+document.documentElement.innerHTML),a):a}catch(e){alert("getLodop出错:"+e)}};var i=null;function n(){try{var e=navigator.userAgent;if(null!=e.match(/Windows\sPhone/i))return!0;if(null!=e.match(/iPhone|iPod/i))return!0;if(null!=e.match(/Android/i))return!0;if(null!=e.match(/Edge\D?\d+/i))return!0;var t=e.match(/Trident\D?\d+/i),a=e.match(/MSIE\D?\d+/i),i=e.match(/OPR\D?\d+/i),n=e.match(/Firefox\D?\d+/i),r=e.match(/x64/i);if(null==t&&null==a&&null!==r)return!0;if(null!==n){if((n=n[0].match(/\d+/))[0]>=42||null!==r)return!0}else if(null!==i){if((i=i[0].match(/\d+/))[0]>=32)return!0}else if(null==t&&null==a){var s=e.match(/Chrome\D?\d+/i);if(null!==s&&(s=s[0].match(/\d+/))[0]>=42)return!0}return!1}catch(e){return!0}}if(n()){var r=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s=document.createElement("script");s.src="http://localhost:8000/CLodopfuncs.js?priority=1",r.insertBefore(s,r.firstChild),(s=document.createElement("script")).src="http://localhost:18000/CLodopfuncs.js?priority=0",r.insertBefore(s,r.firstChild)}},adbP:function(e,t){},"c/Tr":function(e,t,a){e.exports={default:a("5zde"),__esModule:!0}},dY0y:function(e,t,a){var i=a("dSzd")("iterator"),n=!1;try{var r=[7][i]();r.return=function(){n=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var a=!1;try{var r=[7],s=r[i]();s.next=function(){return{done:a=!0}},r[i]=function(){return s},e(r)}catch(e){}return a}},fBQ2:function(e,t,a){"use strict";var i=a("evD5"),n=a("X8DO");e.exports=function(e,t,a){t in e?i.f(e,t,n(0,a)):e[t]=a}},msXi:function(e,t,a){var i=a("77Pl");e.exports=function(e,t,a,n){try{return n?t(i(a)[0],a[1]):t(a)}catch(t){var r=e.return;throw void 0!==r&&i(r.call(e)),t}}},qyJz:function(e,t,a){"use strict";var i=a("+ZMJ"),n=a("kM2E"),r=a("sB3e"),s=a("msXi"),o=a("Mhyx"),c=a("QRG4"),l=a("fBQ2"),d=a("3fs2");n(n.S+n.F*!a("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,n,u,p=r(e),m="function"==typeof this?this:Array,f=arguments.length,h=f>1?arguments[1]:void 0,g=void 0!==h,v=0,b=d(p);if(g&&(h=i(h,f>2?arguments[2]:void 0,2)),void 0==b||m==Array&&o(b))for(a=new m(t=c(p.length));t>v;v++)l(a,v,g?h(p[v],v):p[v]);else for(u=b.call(p),a=new m;!(n=u.next()).done;v++)l(a,v,g?s(u,h,[n.value,v],!0):n.value);return a.length=v,a}})},tIZd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),n=a.n(i),r=a("BO1k"),s=a.n(r),o=a("T1Xa"),c=a("Gu7T"),l=a.n(c),d=a("2MpT"),u={props:{isDisabled:{type:Boolean,default:!1},isCreate:{type:Boolean,default:!1}},data:function(){return{defaultList:[],imgPath:"",visible:!1,uploadList:[]}},methods:{setImgRecord:function(e){this.uploadList=e.map(function(e){return{id:e.id,name:e.name,url:e.pictureUrl,status:"finished"}})},clearImgRecord:function(){this.uploadList=[]},handleView:function(e){this.imgPath=e,this.visible=!0},handleRemove:function(e,t){var a=this;a.$Modal.confirm({title:"删除",content:"确认删除此图片吗？",onOk:function(){a.isCreate?a.uploadList.splice(e,1):(a.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}}),d.a.ajaxPostUtil("/deleteAcceptancePicture?pictureId="+t,{},function(t){a.$Spin.hide(),t.ok?a.uploadList.splice(e,1):a.$Message.error(t.message)},function(){a.$Message.error("网络连接错误"),a.$Spin.hide()},a))}})},handleSuccess:function(e,t){this.$Spin.hide(),e.ok?(this.uploadList.push({id:e.id,name:t.name,url:e.data,status:t.status,showProgress:t.showProgress,percentage:t.percentage}),this.$Message.success(e.message)):this.$Message.error(e.message)},handleFormatError:function(e){this.$Spin.hide(),this.$Notice.warning({title:"文件格式不正确",desc:e.name+"格式不正确, 请选择 jpg 或 png后缀格式."})},handleBeforeUpload:function(){return this.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","正在上传图片中，请稍候......")])}}),!0},getImgRecord:function(){return[].concat(l()(this.uploadList)).map(function(e){return{pictureUrl:e.url}})}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isDisabled?e._e():a("div",{staticStyle:{"margin-bottom":"10px"}},[a("b",[a("Icon",{staticStyle:{"margin-right":"10px"},attrs:{size:"16",type:"md-alert"}}),e._v("请上传与设置信息一致的附件或证明性文件，本系统只接受jpg、png格式文件，请上传前进行确认。")],1)]),e._v(" "),e._l(e.uploadList,function(t,i){return a("div",{key:i,staticClass:"demo-upload-list"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),e._v(" "),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return e.handleView(t.url)}}}),e._v(" "),e.isDisabled?e._e():a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return e.handleRemove(i,t.id)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),e._v(" "),e.isDisabled?e._e():a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.defaultList,"on-success":e.handleSuccess,accept:".jpg,.jpeg,.png",format:["jpg","jpeg","png"],"on-format-error":e.handleFormatError,"before-upload":e.handleBeforeUpload,type:"drag",action:"http://api.tjjnht.cn/api/uploadFile"}},[a("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[a("Icon",{attrs:{type:"ios-cloud-upload-outline",size:"20"}})],1)]),e._v(" "),a("Modal",{attrs:{title:"查看大图"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:e.imgPath}}):e._e()])],2)},staticRenderFns:[]};var m=a("VU/8")(u,p,!1,function(e){a("adbP")},"data-v-753e0edc",null).exports,f={name:"AcceptManage",components:{uploadFile:a("J8Iu").a,imgRecord:m},props:{isDisabled:{type:Boolean,default:!1},isCreate:{type:Boolean,default:!1},capitalList:{type:Array,default:function(){return[]}},orgList:{type:Array,default:function(){return[]}}},data:function(){return{isPop:!1,form:{projectName:"",basicsOrganizationId:"",basicsOrganizationUnderTakeId:"",basicsCapitalId:"",acceptanceType:"",constructionLocation:"",constructionContents:"",inspectionCompleted:"",actualCompletion:"",remarks:"",enclosureList:[],pictureList:[]},ruleValidateType:{projectName:[{required:!0,message:"请填写项目名称",trigger:"blur"}],basicsOrganizationId:[{type:"number",required:!0,message:"请选择主管单位",trigger:"blur"}],basicsOrganizationUnderTakeId:[{type:"number",required:!0,message:"请选择承担单位",trigger:"blur"}],basicsCapitalId:[{type:"number",required:!0,message:"请选择资金类别",trigger:"blur"}],constructionContents:[{required:!0,message:"请填写建设内容",trigger:"blur"}],constructionLocation:[{required:!0,message:"请填写建设位置",trigger:"blur"}],acceptanceType:[{required:!0,message:"请选择验收类别",trigger:"blur"}]},projectList:[]}},created:function(){this.getAllProjectName()},methods:{getAllProjectName:function(){var e=this;e.$Spin.show(),e.commonUtil.ajaxGetUtil("/project/getAllProjectName",{},function(t){e.$Spin.hide(),1===t.code?e.projectList=t.data:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},handleCancel:function(e){this.$refs[e].resetFields(),this.isPop=!1},handleConfirm:function(e){var t=this;t.$refs[e].validate(function(e){if(e){var a=t.isCreate?"/insertAcceptanceForm":"/updateAcceptanceOverWrite",i=n()({},t.form);i.enclosureList=t.$refs.uploadFile.getFiles(),i.pictureList=t.$refs.imgRecord.getImgRecord(),t.isCreate&&(i.archivesNumber=(new Date).getTime()),t.$Spin.show(),d.a.ajaxPostUtil(a,i,function(e){t.$Spin.hide(),e.ok?(t.isPop=!1,t.$Message.success(e.message),t.$emit("refreshList")):t.$Message.error(e.message)},function(){t.$Message.error("网络连接错误"),t.$Spin.hide()},t)}else t.$Message.error("请填写好信息")})},showModal:function(e){var t=this;t.clearForm(),e?(t.$Spin.show(),d.a.ajaxPostUtil("/selectAcceptanceFormById?acceptanceFormId="+e,{},function(e){if(t.$Spin.hide(),e.ok){var a=e.data;a.basicsOrganizationUnderTakeId=a.basicsOrganizationUnderTake?Number(a.basicsOrganizationUnderTake.basicsOrganizationId):null,a.basicsOrganizationId=a.basicsOrganization?Number(a.basicsOrganization.basicsOrganizationId):null,a.basicsCapitalId=a.basicsCapital?Number(a.basicsCapital.basicsCapitalId):null,t.form=a,t.$nextTick(function(){t.$refs.uploadFile.getFileItems(a.enclosureList),t.$refs.imgRecord.setImgRecord(a.pictureList),t.isPop=!0})}else t.$Message.error(e.msg)},function(){t.$Message.error("网络连接错误"),t.$Spin.hide()},t)):t.isPop=!0},clearForm:function(){this.form={projectName:"",basicsOrganizationId:"",basicsOrganizationUnderTakeId:"",basicsCapitalId:"",acceptanceType:"",constructionLocation:"",constructionContents:"",actualCompletion:"",inspectionCompleted:"",remarks:"",enclosureList:[],pictureList:[]},this.$refs.form.resetFields();var e=this.$refs.uploadFile,t=this.$refs.imgRecord;e&&e.clearFileItems(),t&&t.clearImgRecord()}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{staticClass:"selStyle specialWidth",attrs:{"mask-closable":!1},model:{value:e.isPop,callback:function(t){e.isPop=t},expression:"isPop"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e.isDisabled?a("span",[e._v("验收管理信息")]):a("span",[e._v(e._s(e.isCreate?"添加":"修改")+"验收管理信息")])]),e._v(" "),a("Tabs",{staticClass:"innerTabStyle",attrs:{animated:!1,value:"name1"}},[a("Form",{ref:"form",attrs:{model:e.form,rules:e.ruleValidateType,"label-width":85}},[a("TabPane",{attrs:{label:"基本信息",name:"name1"}},[a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"项目名称",prop:"projectName"}},[a("Select",{attrs:{disabled:e.isDisabled,clearable:"",filterable:"",transfer:""},model:{value:e.form.projectName,callback:function(t){e.$set(e.form,"projectName",t)},expression:"form.projectName"}},e._l(e.projectList,function(t){return a("Option",{key:t.projectId,attrs:{value:t.projectName}},[e._v(e._s(t.projectName))])}),1)],1)],1),e._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"主管单位",prop:"basicsOrganizationId"}},[a("Select",{attrs:{disabled:e.isDisabled,clearable:"",filterable:"",transfer:""},model:{value:e.form.basicsOrganizationId,callback:function(t){e.$set(e.form,"basicsOrganizationId",t)},expression:"form.basicsOrganizationId"}},e._l(e.orgList,function(t){return a("Option",{key:t.orgId,attrs:{value:t.orgId}},[e._v(e._s(t.orgName))])}),1)],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"承担单位",prop:"basicsOrganizationUnderTakeId"}},[a("Select",{attrs:{disabled:e.isDisabled,clearable:"",filterable:"",transfer:""},model:{value:e.form.basicsOrganizationUnderTakeId,callback:function(t){e.$set(e.form,"basicsOrganizationUnderTakeId",t)},expression:"form.basicsOrganizationUnderTakeId"}},e._l(e.orgList,function(t){return a("Option",{key:t.orgId,attrs:{value:t.orgId}},[e._v(e._s(t.orgName))])}),1)],1)],1),e._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"资金类别",prop:"basicsCapitalId"}},[a("Select",{attrs:{disabled:e.isDisabled,clearable:"",filterable:"",transfer:""},model:{value:e.form.basicsCapitalId,callback:function(t){e.$set(e.form,"basicsCapitalId",t)},expression:"form.basicsCapitalId"}},e._l(e.capitalList,function(t){return a("Option",{key:t.capitalId,attrs:{value:t.capitalId}},[e._v(e._s(t.capitalName))])}),1)],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"验收类别",prop:"acceptanceType"}},[a("Select",{attrs:{disabled:e.isDisabled,clearable:"",transfer:"",placeholder:"请填写验收类别"},model:{value:e.form.acceptanceType,callback:function(t){e.$set(e.form,"acceptanceType","string"==typeof t?t.trim():t)},expression:"form.acceptanceType"}},[a("Option",{attrs:{value:"区级"}},[e._v("区级")]),e._v(" "),a("Option",{attrs:{value:"市级"}},[e._v("市级")]),e._v(" "),a("Option",{attrs:{value:"自验"}},[e._v("自验")])],1)],1)],1),e._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"建设位置",prop:"constructionLocation"}},[a("Input",{attrs:{disabled:e.isDisabled,clearable:"",placeholder:"请填写建设位置"},model:{value:e.form.constructionLocation,callback:function(t){e.$set(e.form,"constructionLocation","string"==typeof t?t.trim():t)},expression:"form.constructionLocation"}})],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"建设内容",prop:"constructionContents"}},[a("Input",{attrs:{disabled:e.isDisabled,clearable:"",placeholder:"请填写建设内容"},model:{value:e.form.constructionContents,callback:function(t){e.$set(e.form,"constructionContents","string"==typeof t?t.trim():t)},expression:"form.constructionContents"}})],1)],1)],1)],1),e._v(" "),a("TabPane",{attrs:{label:"验收情况",name:"name2"}},[a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"检验结果"}},[a("Select",{attrs:{disabled:e.isDisabled,clearable:"",placeholder:"请选择检验结果"},model:{value:e.form.inspectionCompleted,callback:function(t){e.$set(e.form,"inspectionCompleted","string"==typeof t?t.trim():t)},expression:"form.inspectionCompleted"}},[a("Option",{attrs:{value:"合格"}},[e._v("合格")]),e._v(" "),a("Option",{attrs:{value:"不合格"}},[e._v("不合格")])],1)],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"实际完成"}},[a("Input",{attrs:{type:"textarea",disabled:e.isDisabled,autosize:{minRows:1,maxRows:5},placeholder:"请填写实际完成"},model:{value:e.form.actualCompletion,callback:function(t){e.$set(e.form,"actualCompletion",t)},expression:"form.actualCompletion"}})],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"情况备注"}},[a("Input",{attrs:{type:"textarea",disabled:e.isDisabled,autosize:{minRows:1,maxRows:5},placeholder:"请填写情况备注"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1)],1)],1),e._v(" "),a("TabPane",{attrs:{label:"图像记录",name:"name3"}},[a("imgRecord",{ref:"imgRecord",attrs:{"is-disabled":e.isDisabled,"is-create":e.isCreate}})],1),e._v(" "),a("TabPane",{attrs:{label:"附件",name:"name7"}},[a("uploadFile",{ref:"uploadFile",attrs:{flag:"","is-disabled":e.isDisabled,form:e.form,"is-create":e.isCreate}})],1)],1)],1),e._v(" "),a("p",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{icon:"md-print"}},[e._v("打印")]),e._v(" "),a("Button",{attrs:{icon:"md-exit"}},[e._v("导出")]),e._v(" "),e.isDisabled?e._e():a("Button",{staticStyle:{float:"right","margin-left":"8px"},on:{click:function(t){return e.handleCancel("form")}}},[e._v("\n        取消\n      ")]),e._v(" "),e.isDisabled?e._e():a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("form")}}},[e._v("\n        确认\n      ")])],1)],1)],1)},staticRenderFns:[]},g=a("VU/8")(f,h,!1,null,null,null).exports,v=a("QeYY"),b=a("TwlK"),_=a.n(b),y={name:"AcceptManage",components:{Crumbs:v.a,acceptModal:g},data:function(){var e=this;return{archivesNumber:null,showSelect:!1,isScreen:!1,searchData:{pageNo:1,pageSize:10,acceptanceTime:null,acceptanceType:null,basicsCapitalId:null,basicsOrganizationUnderTakeId:null,basicsOrganizationId:null},isCreate:!1,total:0,acceptList:[],isDisabled:!1,columns:[{type:"selection",width:60,align:"center",fixed:"left"},{type:"index",title:"序号",width:60,align:"center",indexMethod:this.indexMethod},{title:"项目名称",key:"projectName",render:function(t,a){return t("span",{style:{color:"#2d8cf0",cursor:"pointer"},on:{click:function(){e.showInfo(a.row.id)}}},a.row.projectName)}},{title:"主管单位",key:"basicsOrganization",render:function(e,t){var a=t.row.basicsOrganization;return e("div",a?a.basicsOrganizationName:"")}},{title:"承担单位",key:"basicsOrganization",render:function(e,t){var a=t.row.basicsOrganizationUnderTake;return e("div",a?a.basicsOrganizationName:"")}},{title:"资金类别",key:"basicsCapital",render:function(e,t){var a=t.row.basicsCapital;return e("div",a?a.basicsCapitalName:"")}},{title:"验收类别",key:"acceptanceType"},{title:"建设位置",key:"constructionLocation"},{title:"建设内容",key:"constructionContents"},{title:"检验结果",key:"inspectionCompleted"},{title:"档案编码",key:"archivesNumber",width:240,render:function(e,t){return e("img",{attrs:{id:"code"+t.row.id,style:"width: 220px;height: 70px;"}})}},{title:"验收时间",key:"acceptanceTime",render:function(t,a){return t("div",a.row.acceptanceTime?e.$moment(a.row.acceptanceTime).format("YYYY年MM月DD日"):"")}}],capitalList:[],orgList:[],allList:{}}},mounted:function(){this.searchList(),this.getListTotal(),this.getOrganizeData(),this.getFundData()},methods:{getStartIndex:function(e,t,a){var i=Math.ceil(e/a);return((t=t>i?i:t)-1)*a},searchListByCode:function(){var e=this.archivesNumber;if(e){var t=this.allList.data;if(null!==t&&0!==t.length){var a=t.filter(function(t){return-1!==t.archivesNumber.indexOf(e)}),i=this.searchData.pageNo,n=this.searchData.pageSize,r=a.length,o=this.getStartIndex(r,i,n),c=i*n,l=r>c?c-1:1===r?1:r-1,d=a.slice(o,l);this.$set(this,"acceptList",d),this.$set(this,"total",r),this.$nextTick(function(){var e=!0,t=!1,a=void 0;try{for(var i,n=s()(d);!(e=(i=n.next()).done);e=!0){var r=i.value;r.archivesNumber&&_()("#code"+r.id,r.archivesNumber,{format:"CODE128",text:r.code,height:70,displayValue:!0,textPosition:"bottom"})}}catch(e){t=!0,a=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw a}}})}}else this.searchList(),this.getListTotal()},getAllList:function(){var e=this;e.$Spin.show(),d.a.ajaxPostUtil("/selectAcceptanceForm",{pageNo:1,pageSize:1e6},function(t){if(e.$Spin.hide(),t.ok){var a=t.data;e.allList={data:a,total:a.length}}else e.$Message.error(t.message)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},printContent:function(e){var t=this.$refs.table.getSelection();if(0!==t.length){var a=t.map(function(e){return e.id}),i=this.$router.resolve({path:"/printView",query:{title:this.$route.meta.title,type:e,ids:a.join(","),isAllSelection:a.length===this.acceptList.length?1:0}}).href;window.open(i,"_blank")}else this.$Message.warning("您未选择内容")},rowClick:function(e,t){this.$refs.table.toggleSelect(t)},getOrganizeData:function(){var e=this;e.$Spin.show(),e.commonUtil.ajaxPostUtil("/organization/searchOrganization/list",{},function(t){e.$Spin.hide(),1===t.code?e.orgList=t.data.orgList:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},getFundData:function(){var e=this;e.$Spin.show(),e.commonUtil.ajaxPostUtil("/capital/searchCapital/list",{},function(t){e.$Spin.hide(),1===t.code?e.capitalList=t.data.capitalList:e.$Message.error(t.msg)},function(t){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},downloadQR:function(){var e=this.$refs.table.getSelection();if(e.length>0){this.printQRCode(e)}else this.$Message.error("请选择行！！")},printQRCode:function(e){var t=Object(o.a)();if(void 0===t)this.$Modal.confirm({title:"打印",content:"您未安装打印控件，是否跳转地址安装？",onOk:function(){window.open("http://www.lodop.net/demolist/CLodop_Setup_for_Win32NT.zip","_blank")}});else{t.PRINT_INIT(""),t.SET_PRINT_STYLE("FontName","方正小标"),t.SET_PRINT_STYLE("FontSize",7),t.SET_PRINT_PAGESIZE(0,"70mm","36mm","报表");var a=!0,i=!1,n=void 0;try{for(var r,c=s()(e);!(a=(r=c.next()).done);a=!0){var l=r.value;t.ADD_PRINT_TEXT("18.31mm","1.06mm","12.17mm","3.97mm","项目名称:"),t.ADD_PRINT_TEXT("18.31mm","12.17mm","62.80mm","3.97mm",l.projectName),t.ADD_PRINT_TEXT("21.75mm","1.06mm","12.17mm","3.97mm","建设单位:"),t.ADD_PRINT_TEXT("21.75mm","12.17mm","62.80mm","3.97mm",l.basicsOrganizationUnderTake?l.basicsOrganizationUnderTake.basicsOrganizationName:""),t.ADD_PRINT_TEXT("25.19mm","1.06mm","12.17mm","3.97mm","建设地点:"),t.ADD_PRINT_TEXT("25.19mm","12.17mm","62.80mm","3.97mm",l.constructionLocation),t.ADD_PRINT_TEXT("28.63mm","1.06mm","12.17mm","3.97mm","建设内容:"),t.ADD_PRINT_TEXT("28.63mm","12.17mm","62.80mm","3.97mm",l.constructionContents),t.ADD_PRINT_BARCODE("0.95mm","1.06mm","75mm","15.5mm","128A",l.archivesNumber),t.SET_PRINT_STYLEA(0,"ShowBarText",0),t.SET_PRINT_STYLEA(0,"Horient",2),t.SET_PRINT_MODE("FULL_HEIGHT_FOR_OVERFLOW",!0),t.NewPage()}}catch(e){i=!0,n=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw n}}t.PRINT_DESIGN()}},indexMethod:function(e){var t=e._index;return this.searchData.pageSize*(this.searchData.pageNo-1)+t+1},handleAdd:function(){this.isCreate=!0,this.isDisabled=!1,this.$refs.acceptModal.showModal()},pageNoChange:function(e){this.searchData.pageNo=e,this.searchList()},pageSizeChange:function(e){this.searchData.pageSize=e,this.searchList()},searchList:function(){var e=this,t=n()({},e.searchData);e.getAllList(),e.$Spin.show(),t.acceptanceTime=t.acceptanceTime||null,d.a.ajaxPostUtil("/selectAcceptanceForm",t,function(t){if(e.$Spin.hide(),t.ok){var a=t.data;e.acceptList=a,e.$nextTick(function(){var e=!0,t=!1,i=void 0;try{for(var n,r=s()(a);!(e=(n=r.next()).done);e=!0){var o=n.value;o.archivesNumber&&_()("#code"+o.id,o.archivesNumber,{format:"CODE128",text:o.code,height:70,displayValue:!0,textPosition:"bottom"})}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}})}else e.$Message.error(t.message)},function(){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},getListTotal:function(){var e=this;e.$Spin.show(),d.a.ajaxGetUtil("/selectPageSizeAll",{},function(t){e.$Spin.hide(),t.ok?e.total=t.data:e.$Message.error(t.message)},function(){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)},isShowScreen:function(e){this.isScreen=e},handleModify:function(){var e=this;e.isCorrentRow()&&e.$nextTick(function(){e.isDisabled=!1,e.isCreate=!1,e.$refs.acceptModal.showModal(e.$refs.table.getSelection()[0].id)})},showInfo:function(e){var t=this;this.$nextTick(function(){t.isDisabled=!0,t.$refs.acceptModal.showModal(e)})},isCorrentRow:function(){var e=this.$refs.table.getSelection();return 0===e.length?(this.$Message.warning("您未选择内容"),!1):!(e.length>1)||(this.$Message.warning("请选中一行！"),!1)},handleDelete:function(){var e=this,t=this.$refs.table.getSelection();t.length>0?e.$Modal.confirm({title:"删除",content:"确认删除此数据吗？",onOk:function(){e.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","加载中")])}});var a=t.map(function(e){return e.id}).join(",");d.a.ajaxPostUtil("/deleteAcceptanceForm?acceptanceFormId="+a,{},function(t){e.$Spin.hide(),t.ok?(e.$Message.success(t.message),e.searchList()):e.$Message.error(t.message)},function(){e.$Message.error("网络连接错误"),e.$Spin.hide()},e)}}):e.$Message.warning("请选择删除行！")}}},T={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"acceptManage"},[a("Crumbs",{attrs:{"parent-manage":"验收管理","children-manage":"验收管理"},on:{isShowScreen:e.isShowScreen}}),e._v(" "),e.isScreen?a("Content",{staticClass:"content screenStyle",style:{padding:"24px",background:"#fff",marginBottom:"10px"}},[a("Form",{attrs:{model:e.searchData,"label-width":65}},[a("Row",{attrs:{type:"flex",justify:"space-between"}},[a("Col",{attrs:{span:"7"}},[a("FormItem",{attrs:{label:"主管单位"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择主管单位",transfer:""},model:{value:e.searchData.basicsOrganizationId,callback:function(t){e.$set(e.searchData,"basicsOrganizationId",t)},expression:"searchData.basicsOrganizationId"}},e._l(e.orgList,function(t){return a("Option",{key:t.orgId,attrs:{value:t.orgId}},[e._v(e._s(t.orgName))])}),1)],1)],1),e._v(" "),a("Col",{attrs:{span:"7"}},[a("FormItem",{attrs:{label:"承担单位"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择承担单位",transfer:""},model:{value:e.searchData.basicsOrganizationUnderTakeId,callback:function(t){e.$set(e.searchData,"basicsOrganizationUnderTakeId",t)},expression:"searchData.basicsOrganizationUnderTakeId"}},e._l(e.orgList,function(t){return a("Option",{key:t.orgId,attrs:{value:t.orgId}},[e._v(e._s(t.orgName))])}),1)],1)],1),e._v(" "),a("Col",{attrs:{span:"7"}},[a("FormItem",{attrs:{label:"资金类别"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择资金类别",transfer:""},model:{value:e.searchData.basicsCapitalId,callback:function(t){e.$set(e.searchData,"basicsCapitalId",t)},expression:"searchData.basicsCapitalId"}},e._l(e.capitalList,function(t){return a("Option",{key:t.capitalId,attrs:{value:t.capitalId}},[e._v(e._s(t.capitalName))])}),1)],1)],1)],1),e._v(" "),a("Row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"space-between"}},[a("Col",{attrs:{span:"7"}},[a("FormItem",{attrs:{label:"验收类别"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择验收类别",transfer:""},model:{value:e.searchData.acceptanceType,callback:function(t){e.$set(e.searchData,"acceptanceType",t)},expression:"searchData.acceptanceType"}},[a("Option",{attrs:{value:"区级"}},[e._v("区级")]),e._v(" "),a("Option",{attrs:{value:"市级"}},[e._v("市级")]),e._v(" "),a("Option",{attrs:{value:"自验"}},[e._v("自验")])],1)],1)],1),e._v(" "),a("Col",{attrs:{span:"7"}},[a("FormItem",{attrs:{label:"验收时间"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",transfer:"",placeholder:"请选择验收时间",placement:"bottom-start"},model:{value:e.searchData.acceptanceTime,callback:function(t){e.$set(e.searchData,"acceptanceTime",t)},expression:"searchData.acceptanceTime"}})],1)],1),e._v(" "),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"7"}},[a("Button",{attrs:{type:"primary"},on:{click:e.searchList}},[e._v("\n          确认\n        ")])],1)],1)],1)],1):e._e(),e._v(" "),a("img",{staticStyle:{display:"none"},attrs:{id:"showPic"}}),e._v(" "),a("Content",{staticClass:"content",style:{padding:"14px 24px",minHeight:"220px",background:"#fff"}},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.handleAdd}},[e._v("\n      新增\n    ")]),e._v(" "),a("Button",{attrs:{type:"primary",icon:"ios-create"},on:{click:e.handleModify}},[e._v("\n      修改\n    ")]),e._v(" "),a("Button",{attrs:{type:"primary",icon:"md-close"},on:{click:e.handleDelete}},[e._v("\n      删除\n    ")]),e._v(" "),a("Button",{attrs:{icon:"md-print"},on:{click:function(t){return t.stopPropagation(),e.printContent(23)}}},[e._v("\n      打印\n    ")]),e._v(" "),a("Button",{attrs:{icon:"md-cloud-download"},on:{click:function(t){return e.downloadQR()}}},[e._v("\n      条形码打印\n    ")]),e._v(" "),a("div",{staticClass:"quickSearch"},[a("strong",[e._v("快速查询：")]),e._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"档案编码"},on:{input:e.searchListByCode},model:{value:e.archivesNumber,callback:function(t){e.archivesNumber=t},expression:"archivesNumber"}})],1),e._v(" "),a("Table",{ref:"table",staticClass:"table",attrs:{"highlight-row":"",columns:e.columns,data:e.acceptList},on:{"on-row-click":e.rowClick}}),e._v(" "),a("Page",{staticStyle:{"text-align":"right"},attrs:{total:e.total,current:e.searchData.pageNo,"page-size":e.searchData.pageSize,"show-sizer":"",transfer:""},on:{"on-change":e.pageNoChange,"on-page-size-change":e.pageSizeChange}})],1),e._v(" "),a("acceptModal",{ref:"acceptModal",attrs:{"is-create":e.isCreate,"capital-list":e.capitalList,"org-list":e.orgList,"is-disabled":e.isDisabled},on:{refreshList:e.searchList}})],1)},staticRenderFns:[]};var I=a("VU/8")(y,T,!1,function(e){a("CvEL")},"data-v-47fdc2fe",null);t.default=I.exports}});
//# sourceMappingURL=1.f42d422b059d6fa4ad18.js.map